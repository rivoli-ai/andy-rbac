@page "/"
@using Andy.Rbac.Web.Services
@inject RbacApiService ApiService

<PageTitle>Dashboard - Andy RBAC</PageTitle>

<div class="page-header">
    <h1>Dashboard</h1>
    <p class="subtitle">Overview of your RBAC system</p>
</div>

@if (_loading)
{
    <div class="loading">
        <div class="spinner"></div>
    </div>
}
else
{
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon primary">A</div>
            <div class="stat-content">
                <div class="stat-label">Applications</div>
                <div class="stat-value">@_stats.Applications</div>
                <a href="applications" class="stat-link">Manage applications</a>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon info">R</div>
            <div class="stat-content">
                <div class="stat-label">Roles</div>
                <div class="stat-value">@_stats.Roles</div>
                <a href="roles" class="stat-link">Manage roles</a>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon success">S</div>
            <div class="stat-content">
                <div class="stat-label">Subjects</div>
                <div class="stat-value">@_stats.Subjects</div>
                <a href="subjects" class="stat-link">Manage subjects</a>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon warning">T</div>
            <div class="stat-content">
                <div class="stat-label">Teams</div>
                <div class="stat-value">@_stats.Teams</div>
                <a href="teams" class="stat-link">Manage teams</a>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Quick Actions</h3>
        </div>
        <div class="d-flex gap-2 flex-wrap">
            <a href="applications" class="btn btn-primary">+ New Application</a>
            <a href="roles" class="btn btn-secondary">+ New Role</a>
            <a href="subjects" class="btn btn-secondary">+ New Subject</a>
            <a href="teams" class="btn btn-secondary">+ New Team</a>
        </div>
    </div>
}

@code {
    private bool _loading = true;
    private DashboardStats _stats = new();

    protected override async Task OnInitializedAsync()
    {
        await LoadDashboardData();
    }

    private async Task LoadDashboardData()
    {
        _loading = true;
        try
        {
            _stats = await ApiService.GetDashboardStatsAsync();
        }
        catch
        {
            _stats = new DashboardStats();
        }
        finally
        {
            _loading = false;
        }
    }
}
